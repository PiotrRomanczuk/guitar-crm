#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# PRE-PUSH SAFETY NET
# Catches issues if developer bypassed pre-commit or modified files after commit
# Should rarely fail if /ship workflow was used (which validates everything)

echo "üöÄ Pre-push safety check..."
echo ""

# Quick ESLint check (full codebase, fast)
echo "üßπ Running ESLint..."
if npm run lint -- --max-warnings 0 > /dev/null 2>&1; then
  echo "‚úÖ ESLint passed"
else
  echo "‚ùå ESLint failed"
  echo ""
  echo "Running ESLint with details:"
  npm run lint -- --max-warnings 0
  echo ""
  echo "Fix the issues above before pushing"
  exit 1
fi

# Quick TypeScript check
echo "üîß Running TypeScript check..."
if npx tsc --noEmit > /dev/null 2>&1; then
  echo "‚úÖ TypeScript check passed"
else
  echo "‚ùå TypeScript errors found"
  echo ""
  echo "Running TypeScript with details:"
  npx tsc --noEmit
  echo ""
  echo "Fix the type errors above before pushing"
  exit 1
fi

echo ""
echo "‚úÖ Pre-push checks passed!"
echo ""
