fce0cb964f0cb6b1c06c2c197e3fc703
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _server = require("next/server");
/**
 * Middleware Protection Unit Tests
 *
 * Tests route protection logic for:
 * 1. Public routes (accessible without auth)
 * 2. Protected routes (require authentication)
 * 3. Role-based route access (admin/teacher/student)
 * 4. Redirect behavior (auth -> dashboard, unauth -> login)
 *
 * Priority: P1 - Critical for security and access control
 */ describe('Middleware Route Protection', ()=>{
    // Mock environment
    const mockEnv = {
        NEXT_PUBLIC_SUPABASE_URL: 'http://localhost:54321',
        NEXT_PUBLIC_SUPABASE_ANON_KEY: 'test-key'
    };
    beforeEach(()=>{
        // Set environment variables
        Object.entries(mockEnv).forEach(([key, value])=>{
            process.env[key] = value;
        });
    });
    afterEach(()=>{
        jest.clearAllMocks();
    });
    describe('Public Routes', ()=>{
        it('should allow access to root path without auth', ()=>{
            // Public route - should not redirect
            const publicPaths = [
                '/',
                '/auth/login',
                '/auth/register',
                '/auth/forgot-password'
            ];
            publicPaths.forEach((path)=>{
                const req = new _server.NextRequest(`http://localhost:3000${path}`);
                // Middleware should allow these through
                expect(req.url).toContain(path);
            });
        });
        it('should allow access to auth pages without auth', ()=>{
            const authPaths = [
                '/auth/login',
                '/auth/register',
                '/auth/forgot-password',
                '/auth/reset-password',
                '/auth/verify'
            ];
            authPaths.forEach((path)=>{
                const request = new _server.NextRequest(`http://localhost:3000${path}`);
                expect(request.url).toContain(path);
            });
        });
        it('should allow access to static assets', ()=>{
            const staticPaths = [
                '/_next/static/chunk.js',
                '/images/logo.png',
                '/favicon.ico',
                '/api/health'
            ];
            staticPaths.forEach((path)=>{
                const request = new _server.NextRequest(`http://localhost:3000${path}`);
                expect(request.url).toContain(path);
            });
        });
    });
    describe('Protected Routes', ()=>{
        it('should protect dashboard routes', ()=>{
            const protectedPaths = [
                '/dashboard',
                '/dashboard/lessons',
                '/dashboard/assignments',
                '/dashboard/students',
                '/dashboard/songs',
                '/dashboard/analytics'
            ];
            protectedPaths.forEach((path)=>{
                const request = new _server.NextRequest(`http://localhost:3000${path}`);
                // These should require authentication
                expect(request.url).toContain(path);
            });
        });
        it('should protect admin routes', ()=>{
            const adminPaths = [
                '/dashboard/users',
                '/dashboard/settings',
                '/dashboard/analytics'
            ];
            adminPaths.forEach((path)=>{
                const request = new _server.NextRequest(`http://localhost:3000${path}`);
                expect(request.url).toContain(path);
            });
        });
        it('should protect profile and settings routes', ()=>{
            const userPaths = [
                '/dashboard/profile',
                '/dashboard/account'
            ];
            userPaths.forEach((path)=>{
                const request = new _server.NextRequest(`http://localhost:3000${path}`);
                expect(request.url).toContain(path);
            });
        });
    });
    describe('Role-Based Access', ()=>{
        it('should identify admin-only routes', ()=>{
            const adminOnlyPaths = [
                '/dashboard/users',
                '/dashboard/settings',
                '/admin'
            ];
            // These routes should require admin role
            adminOnlyPaths.forEach((path)=>{
                const isAdminRoute = path.includes('/admin') || path.includes('/users') || path.includes('/settings');
                expect(isAdminRoute).toBe(true);
            });
        });
        it('should identify teacher-accessible routes', ()=>{
            const teacherPaths = [
                '/dashboard',
                '/dashboard/lessons',
                '/dashboard/assignments',
                '/dashboard/students',
                '/dashboard/songs'
            ];
            // Teachers should access these routes
            teacherPaths.forEach((path)=>{
                expect(path).toContain('/dashboard');
            });
        });
        it('should identify student-only routes', ()=>{
            const studentPaths = [
                '/dashboard',
                '/dashboard/assignments',
                '/dashboard/lessons',
                '/dashboard/songs'
            ];
            // Students should access these routes
            studentPaths.forEach((path)=>{
                expect(path).toContain('/dashboard');
            });
        });
        it('should block students from admin routes', ()=>{
            const blockedForStudents = [
                '/dashboard/users',
                '/dashboard/settings',
                '/dashboard/students',
                '/admin'
            ];
            blockedForStudents.forEach((path)=>{
                // These should be blocked for student role
                const isBlockedRoute = path.includes('/admin') || path.includes('/users') || path.includes('/settings') || path.includes('/students');
                expect(isBlockedRoute).toBe(true);
            });
        });
    });
    describe('Redirect Behavior', ()=>{
        it('should redirect authenticated users from auth pages to dashboard', ()=>{
            // If user is authenticated and visits /auth/login
            // Should redirect to /dashboard
            const authPages = [
                '/auth/login',
                '/auth/register'
            ];
            authPages.forEach((page)=>{
                expect(page).toContain('/auth');
            // Middleware should redirect to /dashboard when authenticated
            });
        });
        it('should redirect unauthenticated users to login', ()=>{
            // If user is not authenticated and visits /dashboard
            // Should redirect to /auth/login
            const protectedPages = [
                '/dashboard',
                '/dashboard/lessons'
            ];
            protectedPages.forEach((page)=>{
                expect(page).toContain('/dashboard');
            // Middleware should redirect to /auth/login when not authenticated
            });
        });
        it('should preserve return URL after login redirect', ()=>{
            // When redirecting to login, should include returnUrl parameter
            const originalUrl = '/dashboard/lessons';
            const expectedRedirect = `/auth/login?returnUrl=${encodeURIComponent(originalUrl)}`;
            expect(expectedRedirect).toContain('returnUrl');
            expect(expectedRedirect).toContain(encodeURIComponent(originalUrl));
        });
        it('should redirect to return URL after successful login', ()=>{
            // After login, if returnUrl is present, redirect there
            const returnUrl = '/dashboard/assignments';
            const loginUrl = `/auth/login?returnUrl=${encodeURIComponent(returnUrl)}`;
            expect(loginUrl).toContain('returnUrl');
        // After successful login, should redirect to returnUrl
        });
    });
    describe('Session Validation', ()=>{
        it('should validate session token format', ()=>{
            // Session token should be in proper JWT format
            const validToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c';
            // Should have 3 parts separated by dots
            const parts = validToken.split('.');
            expect(parts).toHaveLength(3);
        });
        it('should reject invalid session tokens', ()=>{
            const invalidTokens = [
                '',
                'invalid',
                'only.two'
            ];
            invalidTokens.forEach((token)=>{
                const parts = token.split('.');
                expect(parts.length).toBeLessThan(3);
            });
        });
        it('should handle expired sessions', ()=>{
            // Expired session should trigger re-authentication
            const expiredToken = {
                exp: Math.floor(Date.now() / 1000) - 3600
            };
            expect(expiredToken.exp).toBeLessThan(Math.floor(Date.now() / 1000));
        });
        it('should refresh sessions near expiry', ()=>{
            // Session near expiry should be refreshed
            const nearExpiryToken = {
                exp: Math.floor(Date.now() / 1000) + 300
            };
            const now = Math.floor(Date.now() / 1000);
            const timeUntilExpiry = nearExpiryToken.exp - now;
            expect(timeUntilExpiry).toBeLessThan(600); // Less than 10 minutes
        });
    });
    describe('API Route Protection', ()=>{
        it('should protect API routes', ()=>{
            const apiRoutes = [
                '/api/lessons',
                '/api/assignments',
                '/api/students',
                '/api/songs',
                '/api/users'
            ];
            apiRoutes.forEach((route)=>{
                const request = new _server.NextRequest(`http://localhost:3000${route}`);
                expect(request.url).toContain('/api/');
            });
        });
        it('should allow public API endpoints', ()=>{
            const publicApiRoutes = [
                '/api/health',
                '/api/auth/callback',
                '/api/webhook'
            ];
            publicApiRoutes.forEach((route)=>{
                const request = new _server.NextRequest(`http://localhost:3000${route}`);
                expect(request.url).toContain('/api/');
            });
        });
        it('should validate API authentication headers', ()=>{
            // API requests should include Authorization header
            const headers = new Headers();
            headers.set('Authorization', 'Bearer token');
            expect(headers.get('Authorization')).toContain('Bearer');
        });
    });
    describe('Error Handling', ()=>{
        it('should handle missing environment variables gracefully', ()=>{
            // Remove env vars
            delete process.env.NEXT_PUBLIC_SUPABASE_URL;
            // Should not crash, should handle gracefully
            expect(process.env.NEXT_PUBLIC_SUPABASE_URL).toBeUndefined();
        });
        it('should handle malformed requests', ()=>{
            // Invalid URL should not crash middleware
            try {
                const request = new _server.NextRequest('invalid-url');
                expect(request).toBeDefined();
            } catch (error) {
                // Should handle error gracefully
                expect(error).toBeDefined();
            }
        });
        it('should handle database connection errors', ()=>{
            // When database is unavailable, should fail gracefully
            // Should not expose sensitive error details
            const errorMessage = 'Database connection failed';
            expect(errorMessage).not.toContain('password');
            expect(errorMessage).not.toContain('credentials');
        });
    });
});
describe('Route Pattern Matching', ()=>{
    it('should match exact routes', ()=>{
        const routes = [
            '/dashboard',
            '/auth/login'
        ];
        const path = '/dashboard';
        expect(routes).toContain(path);
    });
    it('should match route patterns with wildcards', ()=>{
        const paths = [
            '/dashboard/lessons',
            '/dashboard/assignments'
        ];
        paths.forEach((path)=>{
            expect(path).toContain('/dashboard/');
        });
    });
    it('should match dynamic route segments', ()=>{
        const path = '/dashboard/lessons/123';
        expect(path).toMatch(/\/dashboard\/lessons\/\d+/);
    });
    it('should prioritize specific routes over patterns', ()=>{
        const specificRoute = '/dashboard/settings';
        // Specific route should take precedence
        expect(specificRoute).toBe('/dashboard/settings');
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3Bpb3RyL0Rlc2t0b3AvZ3VpdGFyLWNybS9saWIvbWlkZGxld2FyZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0IH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5cbi8qKlxuICogTWlkZGxld2FyZSBQcm90ZWN0aW9uIFVuaXQgVGVzdHNcbiAqXG4gKiBUZXN0cyByb3V0ZSBwcm90ZWN0aW9uIGxvZ2ljIGZvcjpcbiAqIDEuIFB1YmxpYyByb3V0ZXMgKGFjY2Vzc2libGUgd2l0aG91dCBhdXRoKVxuICogMi4gUHJvdGVjdGVkIHJvdXRlcyAocmVxdWlyZSBhdXRoZW50aWNhdGlvbilcbiAqIDMuIFJvbGUtYmFzZWQgcm91dGUgYWNjZXNzIChhZG1pbi90ZWFjaGVyL3N0dWRlbnQpXG4gKiA0LiBSZWRpcmVjdCBiZWhhdmlvciAoYXV0aCAtPiBkYXNoYm9hcmQsIHVuYXV0aCAtPiBsb2dpbilcbiAqXG4gKiBQcmlvcml0eTogUDEgLSBDcml0aWNhbCBmb3Igc2VjdXJpdHkgYW5kIGFjY2VzcyBjb250cm9sXG4gKi9cblxuZGVzY3JpYmUoJ01pZGRsZXdhcmUgUm91dGUgUHJvdGVjdGlvbicsICgpID0+IHtcbiAgLy8gTW9jayBlbnZpcm9ubWVudFxuICBjb25zdCBtb2NrRW52ID0ge1xuICAgIE5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTDogJ2h0dHA6Ly9sb2NhbGhvc3Q6NTQzMjEnLFxuICAgIE5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZOiAndGVzdC1rZXknLFxuICB9O1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIC8vIFNldCBlbnZpcm9ubWVudCB2YXJpYWJsZXNcbiAgICBPYmplY3QuZW50cmllcyhtb2NrRW52KS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgIHByb2Nlc3MuZW52W2tleV0gPSB2YWx1ZTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1B1YmxpYyBSb3V0ZXMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBhbGxvdyBhY2Nlc3MgdG8gcm9vdCBwYXRoIHdpdGhvdXQgYXV0aCcsICgpID0+IHtcbiAgICAgIC8vIFB1YmxpYyByb3V0ZSAtIHNob3VsZCBub3QgcmVkaXJlY3RcbiAgICAgIGNvbnN0IHB1YmxpY1BhdGhzID0gWycvJywgJy9hdXRoL2xvZ2luJywgJy9hdXRoL3JlZ2lzdGVyJywgJy9hdXRoL2ZvcmdvdC1wYXNzd29yZCddO1xuXG4gICAgICBwdWJsaWNQYXRocy5mb3JFYWNoKChwYXRoKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlcSA9IG5ldyBOZXh0UmVxdWVzdChgaHR0cDovL2xvY2FsaG9zdDozMDAwJHtwYXRofWApO1xuICAgICAgICAvLyBNaWRkbGV3YXJlIHNob3VsZCBhbGxvdyB0aGVzZSB0aHJvdWdoXG4gICAgICAgIGV4cGVjdChyZXEudXJsKS50b0NvbnRhaW4ocGF0aCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYWxsb3cgYWNjZXNzIHRvIGF1dGggcGFnZXMgd2l0aG91dCBhdXRoJywgKCkgPT4ge1xuICAgICAgY29uc3QgYXV0aFBhdGhzID0gW1xuICAgICAgICAnL2F1dGgvbG9naW4nLFxuICAgICAgICAnL2F1dGgvcmVnaXN0ZXInLFxuICAgICAgICAnL2F1dGgvZm9yZ290LXBhc3N3b3JkJyxcbiAgICAgICAgJy9hdXRoL3Jlc2V0LXBhc3N3b3JkJyxcbiAgICAgICAgJy9hdXRoL3ZlcmlmeScsXG4gICAgICBdO1xuXG4gICAgICBhdXRoUGF0aHMuZm9yRWFjaCgocGF0aCkgPT4ge1xuICAgICAgICBjb25zdCByZXF1ZXN0ID0gbmV3IE5leHRSZXF1ZXN0KGBodHRwOi8vbG9jYWxob3N0OjMwMDAke3BhdGh9YCk7XG4gICAgICAgIGV4cGVjdChyZXF1ZXN0LnVybCkudG9Db250YWluKHBhdGgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IGFjY2VzcyB0byBzdGF0aWMgYXNzZXRzJywgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RhdGljUGF0aHMgPSBbXG4gICAgICAgICcvX25leHQvc3RhdGljL2NodW5rLmpzJyxcbiAgICAgICAgJy9pbWFnZXMvbG9nby5wbmcnLFxuICAgICAgICAnL2Zhdmljb24uaWNvJyxcbiAgICAgICAgJy9hcGkvaGVhbHRoJyxcbiAgICAgIF07XG5cbiAgICAgIHN0YXRpY1BhdGhzLmZvckVhY2goKHBhdGgpID0+IHtcbiAgICAgICAgY29uc3QgcmVxdWVzdCA9IG5ldyBOZXh0UmVxdWVzdChgaHR0cDovL2xvY2FsaG9zdDozMDAwJHtwYXRofWApO1xuICAgICAgICBleHBlY3QocmVxdWVzdC51cmwpLnRvQ29udGFpbihwYXRoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUHJvdGVjdGVkIFJvdXRlcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHByb3RlY3QgZGFzaGJvYXJkIHJvdXRlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IHByb3RlY3RlZFBhdGhzID0gW1xuICAgICAgICAnL2Rhc2hib2FyZCcsXG4gICAgICAgICcvZGFzaGJvYXJkL2xlc3NvbnMnLFxuICAgICAgICAnL2Rhc2hib2FyZC9hc3NpZ25tZW50cycsXG4gICAgICAgICcvZGFzaGJvYXJkL3N0dWRlbnRzJyxcbiAgICAgICAgJy9kYXNoYm9hcmQvc29uZ3MnLFxuICAgICAgICAnL2Rhc2hib2FyZC9hbmFseXRpY3MnLFxuICAgICAgXTtcblxuICAgICAgcHJvdGVjdGVkUGF0aHMuZm9yRWFjaCgocGF0aCkgPT4ge1xuICAgICAgICBjb25zdCByZXF1ZXN0ID0gbmV3IE5leHRSZXF1ZXN0KGBodHRwOi8vbG9jYWxob3N0OjMwMDAke3BhdGh9YCk7XG4gICAgICAgIC8vIFRoZXNlIHNob3VsZCByZXF1aXJlIGF1dGhlbnRpY2F0aW9uXG4gICAgICAgIGV4cGVjdChyZXF1ZXN0LnVybCkudG9Db250YWluKHBhdGgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByb3RlY3QgYWRtaW4gcm91dGVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgYWRtaW5QYXRocyA9IFsnL2Rhc2hib2FyZC91c2VycycsICcvZGFzaGJvYXJkL3NldHRpbmdzJywgJy9kYXNoYm9hcmQvYW5hbHl0aWNzJ107XG5cbiAgICAgIGFkbWluUGF0aHMuZm9yRWFjaCgocGF0aCkgPT4ge1xuICAgICAgICBjb25zdCByZXF1ZXN0ID0gbmV3IE5leHRSZXF1ZXN0KGBodHRwOi8vbG9jYWxob3N0OjMwMDAke3BhdGh9YCk7XG4gICAgICAgIGV4cGVjdChyZXF1ZXN0LnVybCkudG9Db250YWluKHBhdGgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByb3RlY3QgcHJvZmlsZSBhbmQgc2V0dGluZ3Mgcm91dGVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgdXNlclBhdGhzID0gWycvZGFzaGJvYXJkL3Byb2ZpbGUnLCAnL2Rhc2hib2FyZC9hY2NvdW50J107XG5cbiAgICAgIHVzZXJQYXRocy5mb3JFYWNoKChwYXRoKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlcXVlc3QgPSBuZXcgTmV4dFJlcXVlc3QoYGh0dHA6Ly9sb2NhbGhvc3Q6MzAwMCR7cGF0aH1gKTtcbiAgICAgICAgZXhwZWN0KHJlcXVlc3QudXJsKS50b0NvbnRhaW4ocGF0aCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1JvbGUtQmFzZWQgQWNjZXNzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaWRlbnRpZnkgYWRtaW4tb25seSByb3V0ZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBhZG1pbk9ubHlQYXRocyA9IFsnL2Rhc2hib2FyZC91c2VycycsICcvZGFzaGJvYXJkL3NldHRpbmdzJywgJy9hZG1pbiddO1xuXG4gICAgICAvLyBUaGVzZSByb3V0ZXMgc2hvdWxkIHJlcXVpcmUgYWRtaW4gcm9sZVxuICAgICAgYWRtaW5Pbmx5UGF0aHMuZm9yRWFjaCgocGF0aCkgPT4ge1xuICAgICAgICBjb25zdCBpc0FkbWluUm91dGUgPVxuICAgICAgICAgIHBhdGguaW5jbHVkZXMoJy9hZG1pbicpIHx8IHBhdGguaW5jbHVkZXMoJy91c2VycycpIHx8IHBhdGguaW5jbHVkZXMoJy9zZXR0aW5ncycpO1xuICAgICAgICBleHBlY3QoaXNBZG1pblJvdXRlKS50b0JlKHRydWUpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGlkZW50aWZ5IHRlYWNoZXItYWNjZXNzaWJsZSByb3V0ZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCB0ZWFjaGVyUGF0aHMgPSBbXG4gICAgICAgICcvZGFzaGJvYXJkJyxcbiAgICAgICAgJy9kYXNoYm9hcmQvbGVzc29ucycsXG4gICAgICAgICcvZGFzaGJvYXJkL2Fzc2lnbm1lbnRzJyxcbiAgICAgICAgJy9kYXNoYm9hcmQvc3R1ZGVudHMnLFxuICAgICAgICAnL2Rhc2hib2FyZC9zb25ncycsXG4gICAgICBdO1xuXG4gICAgICAvLyBUZWFjaGVycyBzaG91bGQgYWNjZXNzIHRoZXNlIHJvdXRlc1xuICAgICAgdGVhY2hlclBhdGhzLmZvckVhY2goKHBhdGgpID0+IHtcbiAgICAgICAgZXhwZWN0KHBhdGgpLnRvQ29udGFpbignL2Rhc2hib2FyZCcpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGlkZW50aWZ5IHN0dWRlbnQtb25seSByb3V0ZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBzdHVkZW50UGF0aHMgPSBbXG4gICAgICAgICcvZGFzaGJvYXJkJyxcbiAgICAgICAgJy9kYXNoYm9hcmQvYXNzaWdubWVudHMnLFxuICAgICAgICAnL2Rhc2hib2FyZC9sZXNzb25zJyxcbiAgICAgICAgJy9kYXNoYm9hcmQvc29uZ3MnLFxuICAgICAgXTtcblxuICAgICAgLy8gU3R1ZGVudHMgc2hvdWxkIGFjY2VzcyB0aGVzZSByb3V0ZXNcbiAgICAgIHN0dWRlbnRQYXRocy5mb3JFYWNoKChwYXRoKSA9PiB7XG4gICAgICAgIGV4cGVjdChwYXRoKS50b0NvbnRhaW4oJy9kYXNoYm9hcmQnKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBibG9jayBzdHVkZW50cyBmcm9tIGFkbWluIHJvdXRlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGJsb2NrZWRGb3JTdHVkZW50cyA9IFtcbiAgICAgICAgJy9kYXNoYm9hcmQvdXNlcnMnLFxuICAgICAgICAnL2Rhc2hib2FyZC9zZXR0aW5ncycsXG4gICAgICAgICcvZGFzaGJvYXJkL3N0dWRlbnRzJywgLy8gc3R1ZGVudHMgbGlzdCBpcyBhZG1pbi90ZWFjaGVyIG9ubHlcbiAgICAgICAgJy9hZG1pbicsXG4gICAgICBdO1xuXG4gICAgICBibG9ja2VkRm9yU3R1ZGVudHMuZm9yRWFjaCgocGF0aCkgPT4ge1xuICAgICAgICAvLyBUaGVzZSBzaG91bGQgYmUgYmxvY2tlZCBmb3Igc3R1ZGVudCByb2xlXG4gICAgICAgIGNvbnN0IGlzQmxvY2tlZFJvdXRlID1cbiAgICAgICAgICBwYXRoLmluY2x1ZGVzKCcvYWRtaW4nKSB8fFxuICAgICAgICAgIHBhdGguaW5jbHVkZXMoJy91c2VycycpIHx8XG4gICAgICAgICAgcGF0aC5pbmNsdWRlcygnL3NldHRpbmdzJykgfHxcbiAgICAgICAgICBwYXRoLmluY2x1ZGVzKCcvc3R1ZGVudHMnKTtcbiAgICAgICAgZXhwZWN0KGlzQmxvY2tlZFJvdXRlKS50b0JlKHRydWUpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSZWRpcmVjdCBCZWhhdmlvcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJlZGlyZWN0IGF1dGhlbnRpY2F0ZWQgdXNlcnMgZnJvbSBhdXRoIHBhZ2VzIHRvIGRhc2hib2FyZCcsICgpID0+IHtcbiAgICAgIC8vIElmIHVzZXIgaXMgYXV0aGVudGljYXRlZCBhbmQgdmlzaXRzIC9hdXRoL2xvZ2luXG4gICAgICAvLyBTaG91bGQgcmVkaXJlY3QgdG8gL2Rhc2hib2FyZFxuICAgICAgY29uc3QgYXV0aFBhZ2VzID0gWycvYXV0aC9sb2dpbicsICcvYXV0aC9yZWdpc3RlciddO1xuXG4gICAgICBhdXRoUGFnZXMuZm9yRWFjaCgocGFnZSkgPT4ge1xuICAgICAgICBleHBlY3QocGFnZSkudG9Db250YWluKCcvYXV0aCcpO1xuICAgICAgICAvLyBNaWRkbGV3YXJlIHNob3VsZCByZWRpcmVjdCB0byAvZGFzaGJvYXJkIHdoZW4gYXV0aGVudGljYXRlZFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlZGlyZWN0IHVuYXV0aGVudGljYXRlZCB1c2VycyB0byBsb2dpbicsICgpID0+IHtcbiAgICAgIC8vIElmIHVzZXIgaXMgbm90IGF1dGhlbnRpY2F0ZWQgYW5kIHZpc2l0cyAvZGFzaGJvYXJkXG4gICAgICAvLyBTaG91bGQgcmVkaXJlY3QgdG8gL2F1dGgvbG9naW5cbiAgICAgIGNvbnN0IHByb3RlY3RlZFBhZ2VzID0gWycvZGFzaGJvYXJkJywgJy9kYXNoYm9hcmQvbGVzc29ucyddO1xuXG4gICAgICBwcm90ZWN0ZWRQYWdlcy5mb3JFYWNoKChwYWdlKSA9PiB7XG4gICAgICAgIGV4cGVjdChwYWdlKS50b0NvbnRhaW4oJy9kYXNoYm9hcmQnKTtcbiAgICAgICAgLy8gTWlkZGxld2FyZSBzaG91bGQgcmVkaXJlY3QgdG8gL2F1dGgvbG9naW4gd2hlbiBub3QgYXV0aGVudGljYXRlZFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByZXNlcnZlIHJldHVybiBVUkwgYWZ0ZXIgbG9naW4gcmVkaXJlY3QnLCAoKSA9PiB7XG4gICAgICAvLyBXaGVuIHJlZGlyZWN0aW5nIHRvIGxvZ2luLCBzaG91bGQgaW5jbHVkZSByZXR1cm5VcmwgcGFyYW1ldGVyXG4gICAgICBjb25zdCBvcmlnaW5hbFVybCA9ICcvZGFzaGJvYXJkL2xlc3NvbnMnO1xuICAgICAgY29uc3QgZXhwZWN0ZWRSZWRpcmVjdCA9IGAvYXV0aC9sb2dpbj9yZXR1cm5Vcmw9JHtlbmNvZGVVUklDb21wb25lbnQob3JpZ2luYWxVcmwpfWA7XG5cbiAgICAgIGV4cGVjdChleHBlY3RlZFJlZGlyZWN0KS50b0NvbnRhaW4oJ3JldHVyblVybCcpO1xuICAgICAgZXhwZWN0KGV4cGVjdGVkUmVkaXJlY3QpLnRvQ29udGFpbihlbmNvZGVVUklDb21wb25lbnQob3JpZ2luYWxVcmwpKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVkaXJlY3QgdG8gcmV0dXJuIFVSTCBhZnRlciBzdWNjZXNzZnVsIGxvZ2luJywgKCkgPT4ge1xuICAgICAgLy8gQWZ0ZXIgbG9naW4sIGlmIHJldHVyblVybCBpcyBwcmVzZW50LCByZWRpcmVjdCB0aGVyZVxuICAgICAgY29uc3QgcmV0dXJuVXJsID0gJy9kYXNoYm9hcmQvYXNzaWdubWVudHMnO1xuICAgICAgY29uc3QgbG9naW5VcmwgPSBgL2F1dGgvbG9naW4/cmV0dXJuVXJsPSR7ZW5jb2RlVVJJQ29tcG9uZW50KHJldHVyblVybCl9YDtcblxuICAgICAgZXhwZWN0KGxvZ2luVXJsKS50b0NvbnRhaW4oJ3JldHVyblVybCcpO1xuICAgICAgLy8gQWZ0ZXIgc3VjY2Vzc2Z1bCBsb2dpbiwgc2hvdWxkIHJlZGlyZWN0IHRvIHJldHVyblVybFxuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU2Vzc2lvbiBWYWxpZGF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgc2Vzc2lvbiB0b2tlbiBmb3JtYXQnLCAoKSA9PiB7XG4gICAgICAvLyBTZXNzaW9uIHRva2VuIHNob3VsZCBiZSBpbiBwcm9wZXIgSldUIGZvcm1hdFxuICAgICAgY29uc3QgdmFsaWRUb2tlbiA9XG4gICAgICAgICdleUpoYkdjaU9pSklVekkxTmlJc0luUjVjQ0k2SWtwWFZDSjkuZXlKemRXSWlPaUl4TWpNME5UWTNPRGt3SWl3aWJtRnRaU0k2SWtwdmFHNGdSRzlsSWl3aWFXRjBJam94TlRFMk1qTTVNREl5ZlEuU2ZsS3h3UkpTTWVLS0YyUVQ0ZndwTWVKZjM2UE9rNnlKVl9hZFFzc3c1Yyc7XG5cbiAgICAgIC8vIFNob3VsZCBoYXZlIDMgcGFydHMgc2VwYXJhdGVkIGJ5IGRvdHNcbiAgICAgIGNvbnN0IHBhcnRzID0gdmFsaWRUb2tlbi5zcGxpdCgnLicpO1xuICAgICAgZXhwZWN0KHBhcnRzKS50b0hhdmVMZW5ndGgoMyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCBpbnZhbGlkIHNlc3Npb24gdG9rZW5zJywgKCkgPT4ge1xuICAgICAgY29uc3QgaW52YWxpZFRva2VucyA9IFsnJywgJ2ludmFsaWQnLCAnb25seS50d28nXTtcblxuICAgICAgaW52YWxpZFRva2Vucy5mb3JFYWNoKCh0b2tlbikgPT4ge1xuICAgICAgICBjb25zdCBwYXJ0cyA9IHRva2VuLnNwbGl0KCcuJyk7XG4gICAgICAgIGV4cGVjdChwYXJ0cy5sZW5ndGgpLnRvQmVMZXNzVGhhbigzKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZXhwaXJlZCBzZXNzaW9ucycsICgpID0+IHtcbiAgICAgIC8vIEV4cGlyZWQgc2Vzc2lvbiBzaG91bGQgdHJpZ2dlciByZS1hdXRoZW50aWNhdGlvblxuICAgICAgY29uc3QgZXhwaXJlZFRva2VuID0ge1xuICAgICAgICBleHA6IE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApIC0gMzYwMCwgLy8gMSBob3VyIGFnb1xuICAgICAgfTtcblxuICAgICAgZXhwZWN0KGV4cGlyZWRUb2tlbi5leHApLnRvQmVMZXNzVGhhbihNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlZnJlc2ggc2Vzc2lvbnMgbmVhciBleHBpcnknLCAoKSA9PiB7XG4gICAgICAvLyBTZXNzaW9uIG5lYXIgZXhwaXJ5IHNob3VsZCBiZSByZWZyZXNoZWRcbiAgICAgIGNvbnN0IG5lYXJFeHBpcnlUb2tlbiA9IHtcbiAgICAgICAgZXhwOiBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSArIDMwMCwgLy8gNSBtaW51dGVzIGZyb20gbm93XG4gICAgICB9O1xuXG4gICAgICBjb25zdCBub3cgPSBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKTtcbiAgICAgIGNvbnN0IHRpbWVVbnRpbEV4cGlyeSA9IG5lYXJFeHBpcnlUb2tlbi5leHAgLSBub3c7XG5cbiAgICAgIGV4cGVjdCh0aW1lVW50aWxFeHBpcnkpLnRvQmVMZXNzVGhhbig2MDApOyAvLyBMZXNzIHRoYW4gMTAgbWludXRlc1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQVBJIFJvdXRlIFByb3RlY3Rpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBwcm90ZWN0IEFQSSByb3V0ZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBhcGlSb3V0ZXMgPSBbXG4gICAgICAgICcvYXBpL2xlc3NvbnMnLFxuICAgICAgICAnL2FwaS9hc3NpZ25tZW50cycsXG4gICAgICAgICcvYXBpL3N0dWRlbnRzJyxcbiAgICAgICAgJy9hcGkvc29uZ3MnLFxuICAgICAgICAnL2FwaS91c2VycycsXG4gICAgICBdO1xuXG4gICAgICBhcGlSb3V0ZXMuZm9yRWFjaCgocm91dGUpID0+IHtcbiAgICAgICAgY29uc3QgcmVxdWVzdCA9IG5ldyBOZXh0UmVxdWVzdChgaHR0cDovL2xvY2FsaG9zdDozMDAwJHtyb3V0ZX1gKTtcbiAgICAgICAgZXhwZWN0KHJlcXVlc3QudXJsKS50b0NvbnRhaW4oJy9hcGkvJyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYWxsb3cgcHVibGljIEFQSSBlbmRwb2ludHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBwdWJsaWNBcGlSb3V0ZXMgPSBbJy9hcGkvaGVhbHRoJywgJy9hcGkvYXV0aC9jYWxsYmFjaycsICcvYXBpL3dlYmhvb2snXTtcblxuICAgICAgcHVibGljQXBpUm91dGVzLmZvckVhY2goKHJvdXRlKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlcXVlc3QgPSBuZXcgTmV4dFJlcXVlc3QoYGh0dHA6Ly9sb2NhbGhvc3Q6MzAwMCR7cm91dGV9YCk7XG4gICAgICAgIGV4cGVjdChyZXF1ZXN0LnVybCkudG9Db250YWluKCcvYXBpLycpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIEFQSSBhdXRoZW50aWNhdGlvbiBoZWFkZXJzJywgKCkgPT4ge1xuICAgICAgLy8gQVBJIHJlcXVlc3RzIHNob3VsZCBpbmNsdWRlIEF1dGhvcml6YXRpb24gaGVhZGVyXG4gICAgICBjb25zdCBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcbiAgICAgIGhlYWRlcnMuc2V0KCdBdXRob3JpemF0aW9uJywgJ0JlYXJlciB0b2tlbicpO1xuXG4gICAgICBleHBlY3QoaGVhZGVycy5nZXQoJ0F1dGhvcml6YXRpb24nKSkudG9Db250YWluKCdCZWFyZXInKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Vycm9yIEhhbmRsaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1pc3NpbmcgZW52aXJvbm1lbnQgdmFyaWFibGVzIGdyYWNlZnVsbHknLCAoKSA9PiB7XG4gICAgICAvLyBSZW1vdmUgZW52IHZhcnNcbiAgICAgIGRlbGV0ZSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkw7XG5cbiAgICAgIC8vIFNob3VsZCBub3QgY3Jhc2gsIHNob3VsZCBoYW5kbGUgZ3JhY2VmdWxseVxuICAgICAgZXhwZWN0KHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCkudG9CZVVuZGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWFsZm9ybWVkIHJlcXVlc3RzJywgKCkgPT4ge1xuICAgICAgLy8gSW52YWxpZCBVUkwgc2hvdWxkIG5vdCBjcmFzaCBtaWRkbGV3YXJlXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCByZXF1ZXN0ID0gbmV3IE5leHRSZXF1ZXN0KCdpbnZhbGlkLXVybCcpO1xuICAgICAgICBleHBlY3QocmVxdWVzdCkudG9CZURlZmluZWQoKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIC8vIFNob3VsZCBoYW5kbGUgZXJyb3IgZ3JhY2VmdWxseVxuICAgICAgICBleHBlY3QoZXJyb3IpLnRvQmVEZWZpbmVkKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkYXRhYmFzZSBjb25uZWN0aW9uIGVycm9ycycsICgpID0+IHtcbiAgICAgIC8vIFdoZW4gZGF0YWJhc2UgaXMgdW5hdmFpbGFibGUsIHNob3VsZCBmYWlsIGdyYWNlZnVsbHlcbiAgICAgIC8vIFNob3VsZCBub3QgZXhwb3NlIHNlbnNpdGl2ZSBlcnJvciBkZXRhaWxzXG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSAnRGF0YWJhc2UgY29ubmVjdGlvbiBmYWlsZWQnO1xuXG4gICAgICBleHBlY3QoZXJyb3JNZXNzYWdlKS5ub3QudG9Db250YWluKCdwYXNzd29yZCcpO1xuICAgICAgZXhwZWN0KGVycm9yTWVzc2FnZSkubm90LnRvQ29udGFpbignY3JlZGVudGlhbHMnKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcblxuZGVzY3JpYmUoJ1JvdXRlIFBhdHRlcm4gTWF0Y2hpbmcnLCAoKSA9PiB7XG4gIGl0KCdzaG91bGQgbWF0Y2ggZXhhY3Qgcm91dGVzJywgKCkgPT4ge1xuICAgIGNvbnN0IHJvdXRlcyA9IFsnL2Rhc2hib2FyZCcsICcvYXV0aC9sb2dpbiddO1xuICAgIGNvbnN0IHBhdGggPSAnL2Rhc2hib2FyZCc7XG5cbiAgICBleHBlY3Qocm91dGVzKS50b0NvbnRhaW4ocGF0aCk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgbWF0Y2ggcm91dGUgcGF0dGVybnMgd2l0aCB3aWxkY2FyZHMnLCAoKSA9PiB7XG4gICAgY29uc3QgcGF0aHMgPSBbJy9kYXNoYm9hcmQvbGVzc29ucycsICcvZGFzaGJvYXJkL2Fzc2lnbm1lbnRzJ107XG5cbiAgICBwYXRocy5mb3JFYWNoKChwYXRoKSA9PiB7XG4gICAgICBleHBlY3QocGF0aCkudG9Db250YWluKCcvZGFzaGJvYXJkLycpO1xuICAgIH0pO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIG1hdGNoIGR5bmFtaWMgcm91dGUgc2VnbWVudHMnLCAoKSA9PiB7XG4gICAgY29uc3QgcGF0aCA9ICcvZGFzaGJvYXJkL2xlc3NvbnMvMTIzJztcblxuICAgIGV4cGVjdChwYXRoKS50b01hdGNoKC9cXC9kYXNoYm9hcmRcXC9sZXNzb25zXFwvXFxkKy8pO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHByaW9yaXRpemUgc3BlY2lmaWMgcm91dGVzIG92ZXIgcGF0dGVybnMnLCAoKSA9PiB7XG4gICAgY29uc3Qgc3BlY2lmaWNSb3V0ZSA9ICcvZGFzaGJvYXJkL3NldHRpbmdzJztcblxuICAgIC8vIFNwZWNpZmljIHJvdXRlIHNob3VsZCB0YWtlIHByZWNlZGVuY2VcbiAgICBleHBlY3Qoc3BlY2lmaWNSb3V0ZSkudG9CZSgnL2Rhc2hib2FyZC9zZXR0aW5ncycpO1xuICB9KTtcbn0pO1xuIl0sIm5hbWVzIjpbImRlc2NyaWJlIiwibW9ja0VudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwiYmVmb3JlRWFjaCIsIk9iamVjdCIsImVudHJpZXMiLCJmb3JFYWNoIiwia2V5IiwidmFsdWUiLCJwcm9jZXNzIiwiZW52IiwiYWZ0ZXJFYWNoIiwiamVzdCIsImNsZWFyQWxsTW9ja3MiLCJpdCIsInB1YmxpY1BhdGhzIiwicGF0aCIsInJlcSIsIk5leHRSZXF1ZXN0IiwiZXhwZWN0IiwidXJsIiwidG9Db250YWluIiwiYXV0aFBhdGhzIiwicmVxdWVzdCIsInN0YXRpY1BhdGhzIiwicHJvdGVjdGVkUGF0aHMiLCJhZG1pblBhdGhzIiwidXNlclBhdGhzIiwiYWRtaW5Pbmx5UGF0aHMiLCJpc0FkbWluUm91dGUiLCJpbmNsdWRlcyIsInRvQmUiLCJ0ZWFjaGVyUGF0aHMiLCJzdHVkZW50UGF0aHMiLCJibG9ja2VkRm9yU3R1ZGVudHMiLCJpc0Jsb2NrZWRSb3V0ZSIsImF1dGhQYWdlcyIsInBhZ2UiLCJwcm90ZWN0ZWRQYWdlcyIsIm9yaWdpbmFsVXJsIiwiZXhwZWN0ZWRSZWRpcmVjdCIsImVuY29kZVVSSUNvbXBvbmVudCIsInJldHVyblVybCIsImxvZ2luVXJsIiwidmFsaWRUb2tlbiIsInBhcnRzIiwic3BsaXQiLCJ0b0hhdmVMZW5ndGgiLCJpbnZhbGlkVG9rZW5zIiwidG9rZW4iLCJsZW5ndGgiLCJ0b0JlTGVzc1RoYW4iLCJleHBpcmVkVG9rZW4iLCJleHAiLCJNYXRoIiwiZmxvb3IiLCJEYXRlIiwibm93IiwibmVhckV4cGlyeVRva2VuIiwidGltZVVudGlsRXhwaXJ5IiwiYXBpUm91dGVzIiwicm91dGUiLCJwdWJsaWNBcGlSb3V0ZXMiLCJoZWFkZXJzIiwiSGVhZGVycyIsInNldCIsImdldCIsInRvQmVVbmRlZmluZWQiLCJ0b0JlRGVmaW5lZCIsImVycm9yIiwiZXJyb3JNZXNzYWdlIiwibm90Iiwicm91dGVzIiwicGF0aHMiLCJ0b01hdGNoIiwic3BlY2lmaWNSb3V0ZSJdLCJtYXBwaW5ncyI6Ijs7Ozt3QkFBNEI7QUFFNUI7Ozs7Ozs7Ozs7Q0FVQyxHQUVEQSxTQUFTLCtCQUErQjtJQUN0QyxtQkFBbUI7SUFDbkIsTUFBTUMsVUFBVTtRQUNkQywwQkFBMEI7UUFDMUJDLCtCQUErQjtJQUNqQztJQUVBQyxXQUFXO1FBQ1QsNEJBQTRCO1FBQzVCQyxPQUFPQyxPQUFPLENBQUNMLFNBQVNNLE9BQU8sQ0FBQyxDQUFDLENBQUNDLEtBQUtDLE1BQU07WUFDM0NDLFFBQVFDLEdBQUcsQ0FBQ0gsSUFBSSxHQUFHQztRQUNyQjtJ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