{"version":3,"sources":["/home/piotr/Desktop/guitar-crm/lib/api-keys.ts"],"sourcesContent":["/**\n * API Key utilities for bearer token authentication\n */\nimport crypto from 'crypto';\n\n/**\n * Generate a cryptographically secure API key\n * Format: prefix_randomstring\n * @returns {string} The generated API key\n */\nexport function generateApiKey(): string {\n  const prefix = 'gcrm';\n  const random = crypto.randomBytes(32).toString('base64').replace(/[+/=]/g, '');\n  return `${prefix}_${random}`;\n}\n\n/**\n * Hash an API key using SHA256\n * @param key The API key to hash\n * @returns {string} The hashed key\n */\nexport function hashApiKey(key: string): string {\n  return crypto.createHash('sha256').update(key).digest('hex');\n}\n\n/**\n * Verify that a plain key matches a hashed key\n * @param plainKey The plain API key\n * @param hashedKey The hashed API key from database\n * @returns {boolean} Whether the keys match\n */\nexport function verifyApiKey(plainKey: string, hashedKey: string): boolean {\n  return hashApiKey(plainKey) === hashedKey;\n}\n"],"names":["generateApiKey","hashApiKey","verifyApiKey","prefix","random","crypto","randomBytes","toString","replace","key","createHash","update","digest","plainKey","hashedKey"],"mappings":"AAAA;;CAEC;;;;;;;;;;;QAQeA;eAAAA;;QAWAC;eAAAA;;QAUAC;eAAAA;;;+DA5BG;;;;;;AAOZ,SAASF;IACd,MAAMG,SAAS;IACf,MAAMC,SAASC,eAAM,CAACC,WAAW,CAAC,IAAIC,QAAQ,CAAC,UAAUC,OAAO,CAAC,UAAU;IAC3E,OAAO,GAAGL,OAAO,CAAC,EAAEC,QAAQ;AAC9B;AAOO,SAASH,WAAWQ,GAAW;IACpC,OAAOJ,eAAM,CAACK,UAAU,CAAC,UAAUC,MAAM,CAACF,KAAKG,MAAM,CAAC;AACxD;AAQO,SAASV,aAAaW,QAAgB,EAAEC,SAAiB;IAC9D,OAAOb,WAAWY,cAAcC;AAClC"}